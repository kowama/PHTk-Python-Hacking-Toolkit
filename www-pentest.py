#!/usr/bin/env python
import argparse
import scanner

LINKS_TO_IGNORE=["http://192.168.44.128/dvwa/logout.php"]
LOGIN = {'username': "admin", 'password':"password"}
#To determine after first crawl
LOGIN_URL= "http://192.168.44.128/dvwa/login.php"
def get_arguments():
    parser = argparse.ArgumentParser()
    parser.add_argument("-t", "--target", dest="target", help="The target : http://example.com")
    args = parser.parse_args()
    if not args.target:
        parser.error("[-] Please give target  http://example.com, use --help for more info")
        exit()
    return args

TARGET = get_arguments().target

try:
    sc = scanner.Scanner(TARGET, LINKS_TO_IGNORE)
    sc.login(LOGIN_URL, LOGIN)
    sc.map_site()
    sc.run_test()
   
except KeyboardInterrupt:
    print(" Ctrl+C detected ....Quiting")