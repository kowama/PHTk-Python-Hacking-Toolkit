#!/usr/bin/env python
import requests
import urlparse
from bs4 import BeautifulSoup

target_url = "http://192.168.44.128/mutillidae/index.php?page=dns-lookup.php"

page = requests.get(target_url)
parsed_html = BeautifulSoup(page.content,"html.parser")
page_forms = parsed_html.find_all("form")

for form in page_forms:
    action = form.get("action")
    action_url = urlparse.urljoin(target_url,action)
    method = form.get("method")
    form_inputs = form.find_all("input")

    req_data = {}
    for input in form_inputs:
        input_name = input.get("name")
        input_type = input.get("type")
        input_value = input.get("value")

        if input_type == "text":
            input_value ='some random text'

        req_data[input_name] = input_value

    resp=""
    if method == "post":
        resp = requests.post(action_url, req_data)
    else:
        resp = requests.get(action_url, req_data)
    
    print(resp.content)
